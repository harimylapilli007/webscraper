<system.webServer>
  <webSocket enabled="true" />
  <handlers>
    <add name="Python FastCGI" path="*" verb="*" modules="httpPlatformHandler" resourceType="Unspecified"/>
  </handlers>
  <httpPlatform processPath="D:\home\python364x64\python.exe"
                arguments="%HOME%\site\wwwroot\run.py"
                stdoutLogEnabled="true"
                stdoutLogFile="%HOME%\LogFiles\python.log"
                startupTimeLimit="60"
                processesPerApplication="16">
    <environmentVariables>
      <environmentVariable name="PORT" value="%HTTP_PLATFORM_PORT%" />
      <environmentVariable name="WEBSITE_NODE_DEFAULT_VERSION" value="~18" />
      <environmentVariable name="WEBSOCKETS_ENABLED" value="true" />
      <environmentVariable name="WEBSITE_WEBDEPLOY_USE_SCM" value="true" />
      <environmentVariable name="WEBSITE_ADD_SITENAME_BINDINGS_IN_APPHOST_CONFIG" value="1" />
    </environmentVariables>
  </httpPlatform>
  <rewrite>
    <rules>
      <rule name="WebSocket" stopProcessing="true">
        <match url="^socket.io/" />
        <action type="Rewrite" url="http://localhost:%HTTP_PLATFORM_PORT%/{R:0}" />
      </rule>
      <rule name="WebSocket Upgrade" stopProcessing="true">
        <match url="^socket.io/" />
        <conditions>
          <add input="{HTTP_UPGRADE}" pattern="^websocket$" />
        </conditions>
        <action type="Rewrite" url="http://localhost:%HTTP_PLATFORM_PORT%/{R:0}" />
      </rule>
    </rules>
  </rewrite>
</system.webServer>
